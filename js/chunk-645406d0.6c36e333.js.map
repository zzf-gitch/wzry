{"version":3,"sources":["webpack:///./src/views/index/index.vue","webpack:///./src/views/index/index.vue?64c1","webpack:///./src/views/index/index.vue?caff"],"names":["formData","ref","data","exportClick","filename","a","XLSX","utils","table_to_book","document","getElementById","b","write","bookType","bookSST","type","FileSaver","saveAs","Blob","e","console","log","getOutExcel","onImportEx","file","files","target","fileReader","FileReader","onload","event","result","workList","read","sheet","Sheets","hasOwnProperty","concat","sheet_to_json","forEach","list","id","序号","name","姓名","notes","备注","value","push","error","readAsBinaryString","srrList","total","size","pageIndex","onMounted","ssr","length","currentChange","index","slice","__exports__"],"mappings":"+WAiCA,IAAMA,EAAWC,iBAAI,CACjBC,KAAM,KAGJC,EAAc,WAEhB,IAAMC,EAAW,UAEXC,EAAIC,IAAKC,MAAMC,cAAcC,SAASC,eAAe,UACrDC,EAAIL,IAAKM,MAAMP,EAAG,CACpBQ,SAAU,OACVC,SAAS,EACTC,KAAM,UAEV,IACIC,UAAUC,OACN,IAAIC,KAAK,CAACP,GAAI,CACVI,KAAM,6BAEVX,GAEN,MAAOe,GACLC,QAAQC,IAAIF,GAEhB,OAAOR,GAGLW,EAAc,WAChBnB,KAGEoB,EAAa,SAACC,GAChB,IAAQC,EAAUD,EAAKE,OAAfD,MACFE,EAAa,IAAIC,WACvBD,EAAWE,OAAS,SAACC,GACjB,IACI,IAAQC,EAAWD,EAAMJ,OAAjBK,OAEFC,EAAW1B,IAAK2B,KAAKF,EAAQ,CAAEhB,KAAM,WAEvCb,EAAO,GACX,IAAK,IAAIgC,KAASF,EAASG,OACnBH,EAASG,OAAOC,eAAeF,KAE/BhC,EAAOA,EAAKmC,OAAO/B,IAAKC,MAAM+B,cAAcN,EAASG,OAAOD,MAKpEhC,EAAKqC,SAAQ,SAAApB,GACT,IAAMqB,EAAO,CACTC,GAAItB,EAAEuB,GACNC,KAAMxB,EAAEyB,GACRC,MAAO1B,EAAE2B,IAEb9C,EAAS+C,MAAM7C,KAAK8C,KAAKR,MAE/B,MAAOS,GACL7B,QAAQC,IAAI,YAAa4B,KAIjCtB,EAAWuB,mBAAmBzB,EAAM,KASlCvB,EAAOD,iBAAI,CACbkD,QAAS,GACTC,MAAO,EACPC,KAAM,GACNC,UAAW,EACXd,KAAM,KAEVe,wBAAU,WACNrD,EAAK6C,MAAMI,QAAUK,IAAIA,IAAI,GAAGhB,KAChCtC,EAAK6C,MAAMK,MAAQlD,EAAK6C,MAAMI,QAAQM,OACtCC,OAEJ,IAAMA,EAAgB,SAACC,GACnB,GAAIA,EAMA,OALAzD,EAAK6C,MAAMO,UAAYK,OACvBzD,EAAK6C,MAAMP,KAAOtC,EAAK6C,MAAMI,QAAQS,OAChC1D,EAAK6C,MAAMO,UAAY,GAAKpD,EAAK6C,MAAMM,KACxCnD,EAAK6C,MAAMO,UAAYpD,EAAK6C,MAAMM,OAI1CnD,EAAK6C,MAAMP,KAAOtC,EAAK6C,MAAMI,QAAQS,OAChC1D,EAAK6C,MAAMO,UAAY,GAAKpD,EAAK6C,MAAMM,KACxCnD,EAAK6C,MAAMO,UAAYpD,EAAK6C,MAAMM,O,4hDCzH1C,MAAMQ,EAA2B,IAAgB,EAAQ,CAAC,CAAC,YAAY,qBAExD,gB,kCCRf","file":"js/chunk-645406d0.6c36e333.js","sourcesContent":["<template>\r\n    <div class=\"users\">\r\n        <!-- <video src=\"@/assets/CGkaichang.mp4\" controls=\"controls\" autoplay=\"autoplay\" loop=\"loop\" :webkit-playsinline=\"true\"\r\n        ref=\"video\"></video> -->\r\n        <!-- 前端分页 -->\r\n      <div v-for=\"(item,index) in data.list\" :key=\"index\">\r\n        {{ item.name }}</div>\r\n      <el-pagination background layout=\"prev, pager, next\" :total=\"data.total\" :page-size=\"data.size\"\r\n        @current-change=\"currentChange\" />\r\n    </div>\r\n    <!-- Excel导入功能 -->\r\n    <div class=\"index\">\r\n        <el-button type=\"success\">\r\n            导入：\r\n            <input class=\"file_uploader\" type=\"file\" accept=\".xlsx, .xls\" @input=\"onImportEx\" />\r\n            <!-- accept限定传入的文件格式 -->\r\n        </el-button>\r\n    </div>\r\n    <!-- Excel导出功能 -->\r\n    <div>\r\n        <el-button type=\"primary\" @click=\"getOutExcel\">导出</el-button>\r\n    </div>\r\n    <!-- 表格 -->\r\n    <el-table :data=\"formData.data\" style=\"width: 100%\" id=\"table\">\r\n        <el-table-column prop=\"id\" label=\"id\" width=\"180\" />\r\n        <el-table-column prop=\"name\" label=\"name\" width=\"180\" />\r\n        <el-table-column prop=\"notes\" label=\"notes\" />\r\n    </el-table>\r\n</template>\r\n<script setup>\r\nimport XLSX from 'xlsx'//导入的依赖包\r\n// import FileSaver from \"file-saver\";//导出的依赖包\r\nimport { ref , onMounted } from 'vue'\r\nconst formData = ref({\r\n    data: [],//导入的数据\r\n})\r\n//导出函数\r\nconst exportClick = () => {\r\n    // 导出文件名\r\n    const filename = \"导出.xlsx\";\r\n    // 导出表格加id,通过id获取要导出的表单\r\n    const a = XLSX.utils.table_to_book(document.getElementById(\"table\"));\r\n    const b = XLSX.write(a, {\r\n        bookType: \"xlsx\",\r\n        bookSST: true,\r\n        type: \"array\",\r\n    });\r\n    try {\r\n        FileSaver.saveAs(\r\n            new Blob([b], {\r\n                type: \"application/octet-stream\",\r\n            }),\r\n            filename\r\n        );\r\n    } catch (e) {\r\n        console.log(e);\r\n    }\r\n    return b;\r\n};\r\n\r\nconst getOutExcel = () => {\r\n    exportClick();\r\n}\r\n//导入函数\r\nconst onImportEx = (file) => {\r\n    const { files } = file.target;\r\n    const fileReader = new FileReader(); // 创建FileReader 对象 读取文件\r\n    fileReader.onload = (event) => {\r\n        try {\r\n            const { result } = event.target;\r\n            // 二进制读取 excel表格对象\r\n            const workList = XLSX.read(result, { type: \"binary\" });\r\n            // 存储数据\r\n            let data = [];\r\n            for (let sheet in workList.Sheets) {\r\n                if (workList.Sheets.hasOwnProperty(sheet)) {\r\n                    // 利用 sheet_to_json 方法将 excel 转成 json 数据\r\n                    data = data.concat(XLSX.utils.sheet_to_json(workList.Sheets[sheet]));\r\n                    // break; // 如果只取第一张表，就取消注释这行\r\n                }\r\n            }\r\n            // 最终获取到并且格式化后的 json 数据\r\n            data.forEach(e => {\r\n                const list = {\r\n                    id: e.序号,\r\n                    name: e.姓名,\r\n                    notes: e.备注\r\n                }\r\n                formData.value.data.push(list)\r\n            })\r\n        } catch (error) {\r\n            console.log(\"上传失败,err:\", error);\r\n        }\r\n    };\r\n\r\n    fileReader.readAsBinaryString(files[0]);\r\n}\r\n\r\n\r\n\r\n\r\n//前端分页功能\r\n// import ssr from '../../../public/json/Shikigami.json'\r\n// import { onMounted, ref } from \"vue\";\r\nconst data = ref({\r\n    srrList: [],\r\n    total: 0,\r\n    size: 10,\r\n    pageIndex: 1,\r\n    list: []\r\n})\r\nonMounted(() => {\r\n    data.value.srrList = ssr.ssr[0].list\r\n    data.value.total = data.value.srrList.length\r\n    currentChange()\r\n})\r\nconst currentChange = (index) => {\r\n    if (index) {\r\n        data.value.pageIndex = index\r\n        data.value.list = data.value.srrList.slice(\r\n            (data.value.pageIndex - 1) * data.value.size,\r\n            data.value.pageIndex * data.value.size\r\n        );\r\n        return\r\n    }\r\n    data.value.list = data.value.srrList.slice(\r\n        (data.value.pageIndex - 1) * data.value.size,\r\n        data.value.pageIndex * data.value.size\r\n    );\r\n}\r\n</script>\r\n  \r\n<style scoped>\r\n/* .users {\r\n    width: 100%;\r\n    height: 100%;\r\n    background: url('@/assets/img/index.jpg');\r\n    background-size: 100%;\r\n    overflow-y: hidden;\r\n  } */\r\n\r\n.users video {\r\n    z-index: -1;\r\n    margin: 5% 10%;\r\n    overflow-x: auto;\r\n}\r\n</style>\r\n  ","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=0e23f142&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\D盘\\\\桌面\\\\项目\\\\王者荣耀后台管理系统\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0e23f142\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=0e23f142&scoped=true&lang=css\""],"sourceRoot":""}